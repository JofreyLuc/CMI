@startuml
title Ajouter un livre à sa bibliothèque personnelle

skinparam sequence {
	ArrowColor #046380
	ActorBorderColor #046380
	LifeLineBorderColor blue
	LifeLineBackgroundColor #A9DCDF
	
	GroupBorderColor #80064B
	ActorBackgroundColor #01B0F0
	ActorFontColor #046380
	ActorFontSize 17
	ActorFontName Aapex
}

actor User


hide footbox
activate VueLivre
activate User
User -> VueLivre : Clique sur ajouter
note right : l'utilisateur clique sur le bouton \n"ajouter ce livre à ma bibliothèque"
VueLivre -> script.js : onclick()
activate script.js
script.js -> Slim : POST('..UtilisateurController@ajoutLivre, Livre)
activate Slim
note right : Slim fait le lien entre vue et contrôleur
deactivate script.js
Slim -> UtilisateurController : ajoutLivre(Livre)
deactivate Slim
activate UtilisateurController
note right : le contrôleur récupère les \n informations du livre à ajouter 
UtilisateurController -> UtilisateurController : $livre = Livre
note right : stockage du livre dans $livre
create Possede
UtilisateurController -> Possede : $possede = new Possede($livre, $user)
note right : $user initialisé avec la variable de session

UtilisateurController -> Eloquent : $possede -> save()

activate Eloquent
deactivate Eloquent 
note right : Ajout de la relation Utilisateur / Livre
create Notification 
UtilisateurController -> Notification: $notif = new Notification(id,type,contenu)
UtilisateurController -> Eloquent : $notif->save()
activate Eloquent
deactivate Eloquent
note left : Création et sauvegarde d'une notification
deactivate UtilisateurController
deactivate VueLivre
destroy Possede
destroy Notification

legend center
Frameworks utilisés : slim (développement), cordova (portabilité mobile)


User : l'utilisateur (physique) de l'application
VueLivre : page php sur laquelle se trouve les informtions relativse au livre, l'utilisateur choisit ici de l'ajouter à sa bibliothèque
UtilisateurController : Un contrôleur php gérant l'ajout des livres de la BDD Gutemberg dans la bibliothèque de l'utilisateur
Slim : composantes du framework, utilisées pour simplifier les appels aux fonctions des contrôleurs depuis les vues
script.js : Fichier JS permettant d'exécuter les requêtes AJAX et les appels aux contrôleurs
Eloquent : ORM utilisé pour faire le lien entre la BDD et les classes du modèle, afin de simplifier les requêtes sur la BDD
Notification : Une notification est une entité créée à différents moments lors de la navigation sur le site, elle est stockée dans la liste des notification de l'utilisateur
end legend
@enduml
