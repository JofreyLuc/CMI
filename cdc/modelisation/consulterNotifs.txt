@startuml
title Consulter les notifications de sa liste de suivi

skinparam sequence {
	ArrowColor #046380
	ActorBorderColor #046380
	LifeLineBorderColor blue
	LifeLineBackgroundColor #A9DCDF
	
	GroupBorderColor #80064B
	ActorBackgroundColor #01B0F0
	ActorFontColor #046380
	ActorFontSize 17
	ActorFontName Aapex
}

actor User

hide footbox

User -> vueNotification : arrive sur l'onglet notification des utilisateurs suivis
activate User
vueNotification -> script.js : onload()
activate vueNotification
activate script.js

script.js -> Slim : GET('../NotificationController@affichageNotifications')
deactivate script.js
note right : Slim fait le lien entre vue et contrôleur
activate Slim
Slim -> NotificationController : affichageNotifications()
deactivate Slim
activate NotificationController


NotificationController -> Eloquent : $listUser = Utilisateur::find($userCourant)->listUtilisateur 
activate Eloquent

note left : $userCourant est récupéré \ngrâce à la variable de Session \nOn récupère la liste des utilisateurs \nde l'utilisateur courant grâce à la fonction listUtilisateur
deactivate Eloquent
loop $user : $listUser
NotificationController -> Eloquent : $listNotif = Notification::find($user,true)->recupererFollowed
activate Eloquent

note left : chaque resultat est ajouté \nà la suite des résultats précédents ($notifications)
deactivate Eloquent

end

NotificationController -> Slim : setData($listNotif)
deactivate NotificationController
activate Slim
Slim -> vueNotification : render('vueNotification')
note left : Le controller demande à l'application \nd'afficher la liste des notifications récupérées 

deactivate Slim



legend center
Frameworks utilisés : slim (développement), cordova (portabilité mobile)


User : l'utilisateur (physique) de l'application
VueNotification : page php sur laquelle se trouve les notifications des utilisateurs que celui-ci suit
Slim : composantes du framework, utilisées pour simplifier les appels aux fonctions des contrôleurs depuis les vues
NotificationController : Un contrôleur php permettant récupérer les informations concernant les notifications
script.js : Fichier JS permettant d'exécuter les requêtes AJAX et les appels aux contrôleurs
Eloquent : ORM utilisé pour faire le lien entre la BDD et les classes du modèle, afin de simplifier les requêtes sur la BDD
end legend
@enduml
