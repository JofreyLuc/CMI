@startuml
title Connexion standard

skinparam sequence {
	ArrowColor #046380
	ActorBorderColor #046380
	LifeLineBorderColor blue
	LifeLineBackgroundColor #A9DCDF
	
	GroupBorderColor #80064B
	ActorBackgroundColor #01B0F0
	ActorFontColor #046380
	ActorFontSize 17
	ActorFontName Aapex
}

actor User
hide footbox

activate User
User -> accueil : remplit formulaire

activate accueil

accueil -> script.js : onclick(email, mdp)
activate script.js
deactivate accueil

note right : Fonction déclenchée sur l'appui du bouton
script.js -> Slim : POST('..LoginController@login', email, mdp)
activate Slim
deactivate script.js
note right : Slim fait le lien entre vue et contrôleur
Slim -> LoginController : login(email, mdp)
deactivate Slim
activate LoginController
LoginController -> Eloquent : $user = Utilisateur::find(email, mdp)->trouverUser
note right : On essaie de récupérer les infos\nentrées par l'utilisateur dans la BDD


LoginController -> LoginController : Vérification login
note right : On va vérifier si on a effectivement\npu récupérer les infos de l'utilisateur\n(i.e. qu'elles sont correctes)
LoginController -> Navigateur : Création de variables de session ($_SESSION['user'])
LoginController -> Slim : setData($user)
deactivate LoginController
activate Slim

Slim -> vueConnecte : render('vueConnecte')
deactivate Slim

legend center
Frameworks utilisés : slim (développement), cordova (portabilité mobile)


User : l'utilisateur (physique) de l'application
accueil : Page php générique sur le site depuis laquelle l'utilisateur peut se connecter à tout instant
LoginController : Un contrôleur php gérant les connexions des utilisateurs, communiquant avec la BDD
Slim : composantes du framework, utilisées pour simplifier les appels aux fonctions des contrôleurs depuis les vues
script.js : Fichier JS permettant d'exécuter les requêtes AJAX et les appels aux contrôleurs
Eloquent : ORM utilisé pour faire le lien entre la BDD et les classes du modèle, afin de simplifier les requêtes sur la BDD
Navigateur : Navigateur du client (ici perçu comme une entité servant à stocker les variables de session)
VueConnecte : Page php identique à accueil à la différence que l'utilisateur se voit connecté
end legend
@enduml
